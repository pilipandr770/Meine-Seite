{% extends 'base.html' %}
{% block title %}{{ t('development_hours_title') }}{% endblock %}
{% block content %}
<section class="shop-hero single">
    <div class="shop-hero-content">
        <h1>{{ t('development_hours_title') }}</h1>
        <p>{{ t('development_hours_subtitle') }}</p>
    </div>
</section>

<section class="single-product-wrapper">
    {% if single_product %}
    <div class="single-product-card">
        <div class="single-product-header">
            <div class="single-product-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="single-product-title">
                <h2>{{ single_product.name }}</h2>
                <p class="single-short">{{ single_product.short_description or '' }}</p>
            </div>
        </div>
        <div class="single-product-body">
            <div class="price-block">
                {% if single_product.sale_price %}
                    <span class="price-current">{{ "%.2f"|format(single_product.sale_price) }} €</span>
                    <span class="price-original">{{ "%.2f"|format(single_product.price) }} €</span>
                {% else %}
                    <span class="price-current">{{ "%.2f"|format(single_product.price) }} €</span>
                {% endif %}
            </div>
            <div class="actions">
                <button class="btn btn-primary" id="addHoursBtn" data-product-id="{{ single_product.id }}">
                    {{ t('order') }}
                </button>
                <a href="{{ url_for('shop.product_detail', slug=single_product.slug) }}" class="btn btn-outline">
                    {{ t('details') }}
                </a>
                <!-- Fixed: endpoint name is 'shop.cart' (function cart) not 'shop.cart_view' -->
                <a href="{{ url_for('shop.cart') }}" class="btn btn-outline">
                    {{ t('cart') }}
                </a>
            </div>
        </div>
    </div>
    {% else %}
        <div class="no-product-single">
            <p>{{ t('product_not_available') }}</p>
        </div>
    {% endif %}
</section>

<style>
    /* Shop styles */
    .shop-hero.single {
        padding: 50px 0 30px;
        background: linear-gradient(to right, rgba(0,0,0,0.8), rgba(0,0,0,0.9));
        border-radius: 8px;
        margin-bottom: 40px;
        text-align: center;
    }
    
    .shop-hero h1 {
        color: #0f0;
        font-size: 2.5rem;
        margin-bottom: 1rem;
    }
    
    .shop-hero p {
        color: #fff;
        font-size: 1.2rem;
        max-width: 800px;
        margin: 0 auto;
    }
    
    .single-product-wrapper {display:flex;justify-content:center;align-items:flex-start;margin:0 auto 60px;max-width:900px;}
    .single-product-card {background:rgba(0,0,0,0.75);border:1px solid rgba(15,255,15,0.35);border-radius:14px;padding:32px;max-width:680px;width:100%;box-shadow:0 10px 24px -4px rgba(0,255,0,0.12),0 4px 12px -2px rgba(0,255,0,0.25);position:relative;overflow:hidden;}
    .single-product-card:before {content:"";position:absolute;inset:0;background:radial-gradient(circle at 85% 15%,rgba(0,255,0,0.15),transparent 60%);pointer-events:none;}
    .single-product-header {display:flex;gap:22px;align-items:center;margin-bottom:10px;}
    .single-product-icon {width:86px;height:86px;border-radius:18px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,rgba(0,255,0,0.15),rgba(0,255,0,0.05));border:1px solid rgba(0,255,0,0.3);box-shadow:0 4px 12px -2px rgba(0,255,0,0.25),0 2px 6px -1px rgba(0,255,0,0.3);} 
    .single-product-icon i {font-size:40px;color:#0f0;filter:drop-shadow(0 0 6px rgba(0,255,0,0.5));}
    .single-product-title h2 {margin:0 0 6px;font-size:2.1rem;font-weight:600;background:linear-gradient(90deg,#0f0,#9f9);-webkit-background-clip:text;background-clip:text;color:transparent;letter-spacing:0.5px;}
    .single-short {margin:0;color:#cfc;font-size:0.95rem;line-height:1.45;max-width:520px;opacity:.9;}
    .single-product-body {margin-top:24px;}
    .price-block {display:flex;align-items:baseline;gap:14px;margin-bottom:28px;}
    .price-current {
        color: #0f0;
        font-size: 2.2rem;
        font-weight: bold;
    }
    
    .price-original {
        color: #999;
        text-decoration: line-through;
        font-size: 1.1rem;
    }
    .actions {display:flex;flex-wrap:wrap;gap:14px;}
    .btn {cursor:pointer;}
    .btn-outline {background:transparent;color:#0f0;border:1px solid #0f0;}
    .btn-outline:hover {background:rgba(0,255,0,0.08);}    
    
    .no-product-single {text-align:center;color:#ccc;padding:60px 0;}
    
    .no-products,
    .no-categories {
        grid-column: 1 / -1;
        text-align: center;
        color: #ccc;
        padding: 40px 0;
    }
    
    .btn-primary {
        background-color: #0f0;
        color: #000;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        font-weight: bold;
        text-transform: uppercase;
        text-decoration: none;
        display: inline-block;
        transition: all 0.3s;
    }
    
    .btn-primary:hover {
        background-color: #00cc00;
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(0, 204, 0, 0.3);
    }
    
        @media (max-width: 768px){.single-product-card{padding:24px}.single-product-header{flex-direction:row;align-items:flex-start}.single-product-icon{width:70px;height:70px}.single-product-title h2{font-size:1.6rem}.price-current{font-size:1.9rem}}
</style>
<script>
document.addEventListener('DOMContentLoaded',()=>{
    const btn=document.getElementById('addHoursBtn');
    if(!btn) return;
    btn.addEventListener('click',()=>{
        const id=btn.dataset.productId;
        const original=btn.innerHTML;
        btn.disabled=true;btn.innerHTML='<i class="fas fa-spinner fa-spin"></i>';
        fetch('/shop/cart/add',{method:'POST',headers:{'Content-Type':'application/json','X-CSRF-Token':'{{ csrf_token() }}'},body:JSON.stringify({product_id:parseInt(id,10),quantity:1})})
            .then(r=>r.json()).then(d=>{if(d.success){btn.innerHTML='✔';setTimeout(()=>{btn.innerHTML=original;btn.disabled=false;},1200);}else{alert(d.message||'Error');btn.innerHTML=original;btn.disabled=false;}})
            .catch(e=>{console.error(e);btn.innerHTML=original;btn.disabled=false;});
    });
});
</script>
{% endblock %}
